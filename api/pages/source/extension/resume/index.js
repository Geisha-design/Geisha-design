{"title":"","date":"2022-01-04T16:54:21.079Z","updated":"2022-01-04T16:46:48.519Z","comments":true,"path":"api/pages/source/extension/resume/index.js","covers":null,"excerpt":"","content":"function fillAvatar(data) {\n  var avatar = document.querySelector('#avatar');\n  var photo = document.createElement('img');\n  var fileOpen = document.createElement('input');\n  photo.id = 'photo';\n  photo.src = data.resume.side.avatar;\n  fileOpen.id = 'fileOpen';\n  fileOpen.type = 'file';\n  fileOpen.accept = 'image/*';\n  avatar.appendChild(photo);\n  avatar.appendChild(fileOpen);\n  fileOpen.onchange = function () {\n    var file = fileOpen.files[0];\n    if (file) {\n      var reader = new FileReader();\n      reader.readAsDataURL(file);\n      reader.onload = function () {\n        photo.src = reader.result;\n      }\n    }\n  };\n}\n\nfunction fillBrand(data) {\n  var name = document.querySelector('#name');\n  name.innerHTML = data.resume.side.brand.name;\n  var position = document.querySelector('#position');\n  position.innerHTML = data.resume.side.brand.position;\n}\n\nfunction fillPersonal(data) {\n  var address = document.querySelector('#address');\n  address.innerHTML = data.resume.side.personal.address;\n  var phone = document.querySelector('#phone');\n  phone.innerHTML = data.resume.side.personal.phone;\n  var email = document.querySelector('#email');\n  email.innerHTML = data.resume.side.personal.email;\n  var www = document.querySelector('#www');\n  www.innerHTML = data.resume.side.personal.www;\n  var github = document.querySelector('#github');\n  github.innerHTML = data.resume.side.personal.github;\n}\n\nfunction fillSkill(data) {\n  var frontend = document.querySelector('#frontend');\n  frontend.innerHTML = data.resume.side.skill.frontend;\n  var backend = document.querySelector('#backend');\n  backend.innerHTML = data.resume.side.skill.backend;\n  var database = document.querySelector('#database');\n  database.innerHTML = data.resume.side.skill.database;\n  var tool = document.querySelector('#tool');\n  tool.innerHTML = data.resume.side.skill.tool;\n}\n\nfunction fillLanguage(data) {\n  var language = document.querySelector('#language');\n  if (!language) return;\n  var ruler = language.querySelector('.ruler');\n  var desc = language.querySelector('.desc');\n  var languages = data.resume.side.language;\n  languages.forEach(function (lang) {\n    var block = document.createElement('div');\n    block.style.width = lang.data + '%';\n    ruler.appendChild(block);\n    var name = document.createElement('div');\n    name.innerHTML = lang.name;\n    desc.appendChild(name);\n  });\n}\n\nfunction fillIntro(data) {\n  var intro = document.querySelector('#intro');\n  intro.innerHTML = data.resume.main.intro;\n}\n\nfunction fillEducation(data) {\n  var html = document.querySelector('html');\n  var education = document.querySelector('#education');\n  var edus = data.resume.main.education;\n  edus.forEach(function (edu) {\n    var table = document.createElement('table');\n    var tr0 = document.createElement('tr');\n    var tr1 = document.createElement('tr');\n\n    var school = document.createElement('td');\n    var time = document.createElement('td');\n    school.className = 'school';\n    school.innerHTML = edu.school;\n    time.innerHTML = edu.start.concat(\"&nbsp;-&nbsp;\", edu.end);\n    tr0.appendChild(school);\n    tr0.appendChild(time);\n\n    var field = document.createElement('td');\n    var grade = document.createElement('td');\n    field.innerHTML = edu.field;\n    grade.innerHTML = edu.grade ? (html.lang === 'zh' ? '成绩' : 'Grade') + ':&nbsp;' + edu.grade : '';\n    tr1.appendChild(field);\n    tr1.appendChild(grade);\n\n    table.appendChild(tr0);\n    table.appendChild(tr1);\n\n    if (edu.extend) {\n      var tr2 = document.createElement('tr');\n      var extend = document.createElement('td');\n      var ruler = document.createElement('div');\n      var desc = document.createElement('div');\n      ruler.className = 'ruler';\n      desc.className = 'desc';\n      extend.appendChild(ruler);\n      extend.appendChild(desc);\n      var gridWidth = 100 / edu.semester;\n      edu.extend.forEach(function (ex, i) {\n        if (ex.data.length === 2) {\n          var block = document.createElement('div');\n          var sub = document.createElement('div');\n          sub.className = 'sub';\n          sub.setAttribute('data-num', i + 1);\n          sub.style.width = ex.data[1] * gridWidth + '%';\n          var sup = document.createElement('div');\n          sup.className = 'sup';\n          sup.style.width = ex.data[0] * gridWidth + '%';\n          block.appendChild(sub);\n          block.appendChild(sup);\n          ruler.appendChild(block);\n  \n          var inlineBlock = document.createElement('div');\n          inlineBlock.innerHTML = ex.name;\n          desc.appendChild(inlineBlock);\n        }\n      });\n      tr2.appendChild(extend);\n      table.appendChild(tr2);\n    }\n\n    if (edu.desc) {\n      var tr3 = document.createElement('tr');\n      var desc = document.createElement('td');\n      var ul = document.createElement('ul');\n      edu.desc.forEach(function (text) {\n        var li = document.createElement('li');\n        li.innerHTML = text;\n        ul.appendChild(li);\n      });\n      desc.appendChild(ul);\n      tr3.appendChild(desc);\n      table.appendChild(tr3);\n    }\n\n    education.appendChild(table);\n  });\n}\n\nfunction fillProject(data) {\n  var project = document.querySelector('#project');\n  var projs = data.resume.main.project;\n  projs.forEach(function (proj) {\n    var table = document.createElement('table');\n    var tr0 = document.createElement('tr');\n\n    var title = document.createElement('td');\n    var time = document.createElement('td');\n    title.className = 'title';\n    title.innerHTML = proj.title;\n    time.innerHTML = proj.start.concat(\"&nbsp;-&nbsp;\", proj.end);\n    tr0.appendChild(title);\n    tr0.appendChild(time);\n\n    table.appendChild(tr0);\n\n    var tr1 = document.createElement('tr');\n    var desc = document.createElement('td');\n    var ul = document.createElement('ul');\n    proj.desc.forEach(function (text) {\n      var li = document.createElement('li');\n      li.innerHTML = text;\n      ul.appendChild(li);\n    });\n    desc.appendChild(ul);\n    tr1.appendChild(desc);\n    table.appendChild(tr1);\n\n    project.appendChild(table);\n  });\n}\n\nfunction fillExperience(data) {\n  var experience = document.querySelector('#experience');\n  var exps = data.resume.main.experience;\n  exps.forEach(function (exp) {\n    var table = document.createElement('table');\n    var tr0 = document.createElement('tr');\n    var tr1 = document.createElement('tr');\n\n    var title = document.createElement('td');\n    title.className = 'title';\n    title.innerHTML = exp.title;\n    tr0.appendChild(title);\n\n    var employer = document.createElement('td');\n    var time = document.createElement('td');\n    employer.className = 'employer';\n    employer.innerHTML = exp.employer;\n    time.innerHTML = exp.start.concat(\"&nbsp;-&nbsp;\", exp.end);\n    tr1.appendChild(employer);\n    tr1.appendChild(time);\n\n    table.appendChild(tr0);\n    table.appendChild(tr1);\n\n    var tr2 = document.createElement('tr');\n    var desc = document.createElement('td');\n    var ul = document.createElement('ul');\n    exp.desc.forEach(function (text) {\n      var li = document.createElement('li');\n      li.innerHTML = text;\n      ul.appendChild(li);\n    });\n    desc.appendChild(ul);\n    tr2.appendChild(desc);\n    table.appendChild(tr2);\n\n    experience.appendChild(table);\n  });\n}\n\nfunction highlight(data) {\n  if (Array.isArray(data.keyword) && data.keyword.length) {\n    var main = document.querySelector('#main');\n    data.keyword.forEach(function (word) {\n      main.innerHTML = main.innerHTML.replace(word, '<strong>' + word + '</strong>');\n    });\n  }\n}\n\nfunction fixResume(paper, custom) {\n  var resume = document.querySelector('#resume');\n  var side = document.querySelector('#side');\n  custom && (resume.style.maxWidth = custom);\n  switch (paper.toLowerCase()) {\n    case 'letter':\n      resume.style.minHeight = 279 / 216 * resume.offsetWidth + 'px';\n      break;\n    case 'a4':\n      resume.style.minHeight = 297 / 210 * resume.offsetWidth + 'px';\n  }\n  side.style.height = resume.offsetHeight + 'px';\n}\n\nfunction setPrint() {\n  var print = document.querySelector('#print');\n  print.onclick = function () {\n    window.print ? window.print() : document.execCommand('print');\n  }\n}\n\nfunction generate(data) {\n  if (typeof data === 'object' && data.resume) {\n    fillAvatar(data);\n    fillBrand(data);\n    fillPersonal(data);\n    fillSkill(data);\n    fillLanguage(data);\n    fillIntro(data);\n    fillEducation(data);\n    fillExperience(data);\n    fillProject(data);\n    highlight(data);\n    fixResume(data.size, data.custom_width);\n    setPrint();\n  }\n}\n\nfunction getJSON(options) {\n  if (!options.url) return;\n  var request = new XMLHttpRequest();\n  request.open('get', options.url);\n  request.responseType = 'json';\n  request.addEventListener('readystatechange', function () {\n    if (request.readyState === 4 && request.status === 200 && request.response) {\n      options.success && options.success(request.response);\n    }\n  });\n  request.send();\n}\n\ngetJSON({\n  url: 'data.json',\n  success: generate\n});"}